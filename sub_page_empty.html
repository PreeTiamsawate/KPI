<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS for Bootstrap5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <!-- W3 CSS Link" -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <!-- Local css -->
    <link rel="stylesheet" href="./KPI.css">
    <title>แบบประเมินผลการปฏิบัติงานของพนักงาน</title>

</head>

<body>
    <div class="container-xxl">

        <!-- Header Section ================================================== -->
        <header>
            <div class="headline">
                <div>
                    <img src="./kpi_image/thai logo.png">
                    <span>
                        แบบประเมินศักยภาพของพนักงาน "Competency" ครั้งที่ 1/2565
                        (<span class="QUARTER_YEAR">H1/2022</span>)
                    </span>

                </div>
                <div>
                    <img src="./kpi_image/Icon awesome-user-circle.svg" class="USER_IMAGE">
                    <span class="USER_ID">12345</span>
                    <span class="USER_FULL_NAME">XXXXXX XXXXXXXXX</span>
                </div>
            </div>

            <!-- Filter Bar Section =========================================== -->
            <nav>
                <div class="w3-dropdown-hover">
                    <img src="./kpi_image/score definitions.svg" alt="">
                    <div id="item-7" class="w3-dropdown-content score-definations">
                       <!-- insserted from database -->
                    </div>
                </div>
                <div class="filter-boxes">
                    <div id="filter-btn" class="w3-dropdown-click w3-dropdown-hover">
                        <img src="./kpi_image/Icon material-filter-list.svg">
                        <div class="w3-dropdown-content " id="filter-defination"> Filter </div>
                    </div>
                    <form action="" id="filter-form" class="w3-dropdown-content">
                        <div>
                            <div>
                                <div>
                                    <input class="grade-checkbox" type="checkbox" id="graded" name="graded_number_filter">
                                    <label for="graded">ให้คะแนนแล้ว</label>
                                    <span class="GRADED_NUMBER">(100)</span>
                                </div>
                                <div>
                                    <input class="grade-checkbox" type="checkbox" id="not-graded" name="graded_number_filter">
                                    <label for="not-graded">ยังไม่ให้คะแนน</label>
                                    <span class="NOT_GRADED_NUMBER">(900)</span>
                                </div>
                            </div>
                            <div>
                                <div class="level-checkboxes">
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="1" id="lv1">
                                        <label for="lv1">Lv.1</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="2" id="lv2">
                                        <label for="lv2">Lv.2</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="3" id="lv3">
                                        <label for="lv3">Lv.3</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="4" id="lv4">
                                        <label for="lv4">Lv.4</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="5" id="lv5">
                                        <label for="lv5">Lv.5</label>

                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="6" id="lv6">
                                        <label for="lv6">Lv.6</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="7" id="lv7">
                                        <label for="lv7">Lv.7</label>
                                    </div>
                                </div>
                                <div class="level-checkboxes">
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="8" id="lv8">
                                        <label for="lv8">Lv.8</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="9" id="lv9">
                                        <label for="lv9">Lv.9</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="10" id="lv10">
                                        <label for="lv10">Lv.10</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="11" id="lv11">
                                        <label for="lv11">Lv.11</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="13" id="lv13">
                                        <label for="lv13">Lv.13</label>
                                    </div>
                                    <div>
                                        <input class="level-checkbox" type="checkbox" value="14" id="lv14">
                                        <label for="lv14">Lv.14</label>
                                    </div>
                                </div>
                            </div>

                            <div>
                                <button type="submit" id="use-filter-button">
                                    เลือก
                                </button>
                                <button id="cancel-form-btn">
                                    ล้างตัวเลือก
                                </button>

                            </div>
                        </div>

                    </form>

                    <div id="search-box">
                        <label for="search-id">
                            <img src="./kpi_image/Icon ionic-ios-search.svg" alt="">
                        </label>
                        <input type="text" placeholder="search ID or Name" id="search-id">


                    </div>

                </div>



            </nav>

        </header>
        <nav class="" style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
            <ol class="breadcrumb">
              
            </ol>
        </nav>
        <main id="to-print">
           
            <form action="" method="">
                <table id="GRADE_TABLE">
                    <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                    </colgroup>
                    <!-- Table Header ========================================= -->
                    <thead>
                        <tr>
                            <th rowspan="1" colspan="4">
                                Personnel Information
                            </th>
                            <th></th>
                            <th colspan="3" height="50">
                                Core Competency
                            </th>
                            <th></th>
                            <th colspan="3" height="50">
                                Leadership Competency
                            </th>
                     
                            <th rowspan="2" class="d-none">
                                Total
                            </th>
                            <th rowspan="2"></th>
                            <th rowspan="2">
                                <div class="w3-dropdown-hover">
                                    Weighted Competency (%)
                                    <div class="w3-dropdown-content">
                                        <img src="./kpi_image/total_competency_description.png">
                                    </div>
                                </div>

                            </th>
                        </tr>

                        <tr>
                            <td>Lv</td>
                            <td>ID</td>
                            <td>Function</td>
                            <td>Name-Surname</td>
                            <td></td>
                            <td height="70">
                                <div id="item-1" class="w3-dropdown-hover">
                                    <!-- insserted from database -->
                                    <div class="w3-dropdown-content">
                                        <!-- insserted from database -->
                                    </div>
                                </div>

                            </td>
                            <td>
                                <div id="item-2" class="w3-dropdown-hover">
                                    <!-- insserted from database -->
                                    <div class="w3-dropdown-content">
                                       <!-- insserted from database -->
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div id="item-3" class="w3-dropdown-hover">
                                   <!-- insserted from database -->
                                    <div class="w3-dropdown-content">
                                        <!-- insserted from database -->
                                    </div>
                                </div>
                            </td>
                            <td class="d-none">
                                Total
                            </td>
                            <td></td>
                            <td>
                                <div id="item-4" class="w3-dropdown-hover">
                                   <!-- insserted from database -->
                                    <div class="w3-dropdown-content">
                                       <!-- insserted from database -->
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div id="item-5" class="w3-dropdown-hover">
                                   <!-- insserted from database -->
                                    <div class="w3-dropdown-content">
                                       <!-- insserted from database -->
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div id="item-6" class="w3-dropdown-hover">
                                   <!-- insserted from database -->
                                    <div class="w3-dropdown-content">
                                       <!-- insserted from database -->
                                    </div>
                                </div>
                            </td>
                            <td class="d-none"> 
                                Total
                            </td>
                        </tr>

                    </thead>

                    <!-- Table Body ================================================================ -->
                    <tbody class="grading-tbody">



                    </tbody>


                </table>
                <div class="grid-container ">
                    <div class="grid-item-1">
                        <!-- <button type="submit" id="submitPage">Submit This Page</button> -->
                    </div>
                    <div class="grid-item-2">
                        <div id="pagination-wrapper"></div>
                    </div>
                    <div class="grid-item-3">
                        <div id="page-index-wraper"></div>
                    </div>
                    <!-- <div class="grid-item-4 w3-dropdown-hover">
                        หากท่านมีพนักงานที่ไม่ต้องรับการประเมินฯ
                        <div id="no-grade-btn" class="">

                            <a href="https://forms.office.com/r/qU6KHmMNsA" target="_blank"> 
                                คลิกที่นี่   </a>
                            <p class="w3-dropdown-content">
                                <b>พนักงานกลุ่มที่ไม่ต้องประเมินผลการปฏิบัติงาน </b> <br> คือ พนักงานที่มีวันลา 45 วัน นับรวมวันหยุดในไตรมาสนั้นๆ เช่น พนักงานลาหยุดประเภทต่างๆ ดังนี้ ลาป่วย ลาคลอด ลาเลี้ยงดูบุตร การลาหยุดไม่รับเงินเดือน (Leave without
                                Pay) นักบิน Non-Active ที่ไม่ได้ช่วยงานสำนักงาน เป็นต้น <br> <br> ทั้งนี้ พนักงานที่เกษียณ หรือลาออกระหว่างไตรมาส ต้องทำการประเมินผลเพื่อบันทึกไว้เป็นหลักฐานสำหรับการบริหารจัดการทรัพยากรบุคคลต่อไป
                            </p>
                        </div>
                  

                    </div> -->
                    <!-- <div class="grid-item-5">
                        <div id="preview-btn">
                            <a href="./print.html" target="_blank">Print Preview</a>
                        </div>
                    </div> -->
                </div>


            </form>



        </main>

    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <script src="./sweetalert2.all.min.js"></script>
    <!-- Delete KPI_dummy_json.js below when connected to database!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
   
    <script src="./dummy_data/KPI_score_weight_dummy.js"></script>
    <script src="./dummy_data/KPI_items_json.js"></script>

    <script>
        const score_weights = score_weight_dummy;
        const kpiItems = kpi_items_dummy;
        let rawData = [];
        if(rawData.length == 0 ){
            Swal.fire('สิ้นสุดการแสดงผล')
        }

        const gradedDataInit = rawData.filter(data => data.COMPETENCY_WT100 != null)
        const notGradedDataInit = rawData.filter(data => data.COMPETENCY_WT100 == null)
        let filteredData = rawData

        const updateGradedNumbers = function(data) {
            let gradedFilteredData = data.filter(data => data.COMPETENCY_WT100 != null)
            let notGradedFilteredData = data.filter(data => data.COMPETENCY_WT100 == null)
            const gradedNumber = document.querySelector("span.GRADED_NUMBER")
            const notGradedNumber = document.querySelector("span.NOT_GRADED_NUMBER")
            gradedNumber.innerText = `(${gradedFilteredData.length})`
            notGradedNumber.innerText = `(${notGradedFilteredData.length})`
            console.log("DATA LENGHT: " + data.length)
        }

        var state = {
            // 'querySet': rawData, //data json
            'page': 1, //start page
            'rows': 20, //number of rows showed
            'window': 10, //number of pagination buttons
        }
        const dropdownForm = document.querySelector(".filter-boxes").querySelector("#filter-form");
        const filterBtn = document.querySelector("#filter-btn");
        const filterRadios = document.querySelectorAll(".filter-boxes .grade-checkbox")
        const levelCheckboxes = document.querySelectorAll(".filter-boxes .level-checkbox")
        const useFilterBtn = document.querySelector('#use-filter-button')
        const cancelFormBtn = document.querySelector("#cancel-form-btn")
        const searchInput = document.querySelector("#search-id");
        const callBasicFunctions = function() {
            commentBoxControl()
            dynamicInputControl()
            // assignRowStatus()
            rowStatusBySelect()
            rowStatusByComment()
            commentRequired()
            calculateScores()
            calculateScoresByInput()
        }


        useFilterBtn.addEventListener('click', function(e) {
            e.preventDefault();
            let checkedLevelBoxes = Array.from(levelCheckboxes).filter(levelCheckbox => levelCheckbox.checked)
            let checkedLevelValues = checkedLevelBoxes.map(levelCheckbox => Number(levelCheckbox.value))

            if (filterRadios[0].checked && !filterRadios[1].checked) {
                filteredData = gradedDataInit;


            } else if (!filterRadios[0].checked && filterRadios[1].checked) {
                filteredData = notGradedDataInit;

            } else {
                filteredData = rawData;
            }

            if (checkedLevelValues.length > 0) {
                filteredData = filteredData.filter(data => checkedLevelValues.includes(data.APPRAISAL_LEVEL))
            }

            // console.log(filteredData)
            searchInput.value = ""
            $('.grading-tbody').empty()
            buildTable(filteredData)
            callBasicFunctions()

            dropdownForm.className = dropdownForm.className.replace(" w3-show", "");
            filterBtn.addEventListener("mouseover", btnHoverActive)
            filterBtn.addEventListener("mouseleave", btnHoverOff)
        })
        cancelFormBtn.addEventListener('click', function(e) {
            e.preventDefault();

            dropdownForm.className = dropdownForm.className.replace(" w3-show", "");
            filterBtn.addEventListener("mouseover", btnHoverActive)
            filterBtn.addEventListener("mouseleave", btnHoverOff)

            for (const filterRadio of filterRadios) {
                filterRadio.checked = false
            }
            for (const levelCheckbox of levelCheckboxes) {
                levelCheckbox.checked = false
            }
            filteredData = rawData
            searchInput.value = ""
            $('.grading-tbody').empty()
            buildTable(filteredData)
            callBasicFunctions()
        })
        let dataBySearch = filteredData

        searchInput.addEventListener('input', function() {
            console.log(this.value)
            let filterValue = this.value;

            if (filterValue != "") {
                dataBySearch = filteredData.filter(data => data.EMPLOYEE_ID.includes(filterValue) || data.EMPLOYEE_NAME.toUpperCase().includes(filterValue.toUpperCase()))
            } else {
                dataBySearch = filteredData
            }

            $('.grading-tbody').empty()
            buildTable(dataBySearch)
            callBasicFunctions()

        })
        buildTable(rawData)

        function pagination(querySet, page, rows) {

            var trimStart = (page - 1) * rows
            var trimEnd = trimStart + rows
            console.log("Trim start: " + trimStart);
            console.log("Trim end: " + trimEnd);

            var trimmedData = querySet.slice(trimStart, trimEnd)
            console.log("Trimmed data:", trimmedData);
            var pages = Math.ceil(querySet.length / rows);

            console.log("querySet.length: ", querySet.length)
            console.log("trimmedData.length: ", trimmedData.length)

            return {
                'querySet': trimmedData,
                'pages': pages,
            }
        }

        function pageButtons(data, pages) {
            var wrapper = document.getElementById('pagination-wrapper')
            var index = document.getElementById('page-index-wraper')

            wrapper.innerHTML = ``
            index.innerHTML = ``
            console.log('Pages: ', pages)
            console.log("state.page: ", state.page)
            var maxLeft = (state.page - Math.floor(state.window / 2))
            var maxRight = (state.page + Math.floor(state.window / 2))

            if (maxLeft < 1) {
                maxLeft = 1
                maxRight = state.window
            }

            if (maxRight > pages) {
                maxLeft = pages - (state.window - 1)

                if (maxLeft < 1) {
                    maxLeft = 1
                }
                maxRight = pages
            }

            for (var page = maxLeft; page <= maxRight; page++) {
                wrapper.innerHTML += `<button value=${page} class="page btn">${page}</button>`
            }

            if (state.page != 1 && maxLeft > 1) {
                wrapper.innerHTML = `<button value=${1} class="page btn">&#171; First</button>` + wrapper.innerHTML
            }

            if (state.page != pages && pages > maxRight) {
                wrapper.innerHTML += `<button value=${pages} class="page btn">Last &#187;</button>`
            }
            $(`button[value = ${state.page}]`).css({
                border: "1px solid #330066"
            })
            $('.page').on('click', function(e) {
                $('.grading-tbody').empty()
                state.page = Number($(this).val())
                console.log("click state page: ", state.page);
                $(`button[value = ${state.page}]`).css({
                    border: "1px solid #330066"
                })

                buildTable(data)
                callBasicFunctions()
            })
            index.innerHTML = `Page ${state.page} of ${pages}`

        }

        function buildTable(Data) {

            var table = $('.grading-tbody')
            console.log("state.page to build: ", state.page)


            console.log("screenedData :", Data.length)
                // Here!
            if (Data.length < (state.page - 1) * state.rows + 1) {
                state.page = 1
            }
            var data = pagination(Data, state.page, state.rows)
            var myList = data.querySet

            for (var i in myList) {
                //Keep in mind we are using "Template Litterals to create rows"
                var row = `<tr row-status="">
                            <td class="EMPLOYEE_LEVEL">${myList[i].APPRAISAL_LEVEL}</td>
                            <td class="EMPLOYEE_ID"><a class="employee-link" href="${myList[i].SUB_EMPLOYEE_KPI_URL || ""}">${myList[i].EMPLOYEE_ID}</a></td>
                            <td class="FUNCTION">${myList[i].FUNCTION}</td>
                            <td class="EMPLOYEE_FULLNAME">${myList[i].EMPLOYEE_NAME}</td>
                            <td class="competency-note" note-data="${myList[i].COMPETENCY_REASON_NOTE}">
                                <img class="d-none" src="./kpi_image/icon-info.png" alt="i">
                                <div class="d-none"></div>
                            </td>
                            <td class="service_orientation_score score">
                                <div>
                                    <select disabled name="CSCORE1[${myList[i].EMPLOYEE_ID}]">
                                        <option value=""></option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                    <img src="./kpi_image/Icon-empty-comment.svg" class="w3-dropdown-click">
                                    <textarea readonly name="CSCORE1_COMMENT[${myList[i].EMPLOYEE_ID}]" cols="30" rows="5" class="w3-dropdown-content" maxlength="800" placeholder="คำอธิบายประกอบการประเมิน(ความยาวไม่เกิน 800 ตัวอักษร)">${myList[i].COMPETENCY_REASON_CORE1}</textarea>
                                </div>
                            </td>
                            <td class=" result_orientation_score score ">
                                <div>
                                    <select disabled name="CSCORE2[${myList[i].EMPLOYEE_ID}]">
                                        <option value=""></option>
                                   
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                    <img src="./kpi_image/Icon-empty-comment.svg" class="w3-dropdown-click">
                                    <textarea readonly  name="CSCORE2_COMMENT[${myList[i].EMPLOYEE_ID}]" cols="30" rows="5" class="w3-dropdown-content" maxlength="800" placeholder="คำอธิบายประกอบการประเมิน(ความยาวไม่เกิน 800 ตัวอักษร)">${myList[i].COMPETENCY_REASON_CORE2}</textarea>
                                </div>
                            </td>
                            <td class="flexibility_and_adaptability_score score ">
                                <div>
                                    <select disabled name="CSCORE3[${myList[i].EMPLOYEE_ID}]">
                                        <option value=""></option>
                                      
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                    <img src="./kpi_image/Icon-empty-comment.svg" class="w3-dropdown-click">
                                    <textarea readonly  name="CSCORE3_COMMENT[${myList[i].EMPLOYEE_ID}]" cols="30" rows="5" class="w3-dropdown-content" maxlength="800" placeholder="คำอธิบายประกอบการประเมิน(ความยาวไม่เกิน 800 ตัวอักษร)">${myList[i].COMPETENCY_REASON_CORE3}</textarea>

                                </div>
                            </td>
                            <td class= "core_competency_total total d-none">
                                <input name="CSCORE_TOTAL[${myList[i].EMPLOYEE_ID}]" value="${myList[i].COMPETENCY_WT_CORE}" type="text" readonly>
                            </td>
                            <td></td>
                            <td class="make_it_happen_score score ">
                                <div>
                                    <select disabled name="LSCORE1[${myList[i].EMPLOYEE_ID}]">
                                        <option value=""></option>
                               
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                    <img src="./kpi_image/Icon-empty-comment.svg" class="w3-dropdown-click">
                                    <textarea readonly  name="LSCORE1_COMMENT[${myList[i].EMPLOYEE_ID}]" cols="30" rows="5" class="w3-dropdown-content" maxlength="800" placeholder="คำอธิบายประกอบการประเมิน(ความยาวไม่เกิน 800 ตัวอักษร)">${myList[i].COMPETENCY_REASON_LEAD1}</textarea>

                                </div>
                            </td>
                            <td class="provide_solutions_score score ">
                                <div>
                                    <select disabled name="LSCORE2[${myList[i].EMPLOYEE_ID}]">
                                        <option value=""></option>
                                  
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                    <img src="./kpi_image/Icon-empty-comment.svg" class="w3-dropdown-click">
                                    <textarea readonly  name="LSCORE2_COMMENT[${myList[i].EMPLOYEE_ID}]" cols="30" rows="5" class="w3-dropdown-content" maxlength="800" placeholder="คำอธิบายประกอบการประเมิน(ความยาวไม่เกิน 800 ตัวอักษร)">${myList[i].COMPETENCY_REASON_LEAD2}</textarea>

                                </div>
                            </td>
                            <td class="inspire_people_score score ">
                                <div>
                                    <select disabled name="LSCORE3[${myList[i].EMPLOYEE_ID}]">
                                        <option value=""></option>
                            
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                    </select>
                                    <img src="./kpi_image/Icon-empty-comment.svg" class="w3-dropdown-click">
                                    <textarea readonly  name="LSCORE3_COMMENT[${myList[i].EMPLOYEE_ID}]" cols="30" rows="5" class="w3-dropdown-content" maxlength="800" placeholder="คำอธิบายประกอบการประเมิน(ความยาวไม่เกิน 800 ตัวอักษร)">${myList[i].COMPETENCY_REASON_LEAD3}</textarea>

                                </div>
                            </td>
                            <td class="leadership_competency_total total d-none">
                                <input readonly  name="LSCORE_TOTAL[${myList[i].EMPLOYEE_ID}]" value="${myList[i].COMPETENCY_WT_LEAD}" type="text " readonly>
                            </td>

                            <td class="raw_total grand_total d-none">
                                <input readonly  name="COMPETENCY_TOTAL[${myList[i].EMPLOYEE_ID}]" value="${myList[i].COMPETENCY_WT_TOTAL}" type="text " readonly>
                            </td>
                            <td></td>
                            <td class="total_competency_percent grand_total ">
                                <input readonly  name="COMPETENCY_TOTAL100[${myList[i].EMPLOYEE_ID}]" value="${myList[i].COMPETENCY_WT100}" type="text " readonly>
                            </td>
                            <input type="hidden" name="ORIGINAL_SCORE[${myList[i].EMPLOYEE_ID}]" value="${myList[i].ORIGINAL_SCORE}">
                        </tr>
              `
                table.append(row)
                let n = Number(i) + 1
                let csScore1 = myList[i].COMPETENCY_CORE1 == null ? '""' : myList[i].COMPETENCY_CORE1;
                let csScore2 = myList[i].COMPETENCY_CORE2 == null ? '""' : myList[i].COMPETENCY_CORE2;
                let csScore3 = myList[i].COMPETENCY_CORE3 == null ? '""' : myList[i].COMPETENCY_CORE3;
                let lsScore1 = myList[i].COMPETENCY_LEAD1 == null ? '""' : myList[i].COMPETENCY_LEAD1;
                let lsScore2 = myList[i].COMPETENCY_LEAD2 == null ? '""' : myList[i].COMPETENCY_LEAD2;
                let lsScore3 = myList[i].COMPETENCY_LEAD3 == null ? '""' : myList[i].COMPETENCY_LEAD3;

                console.log("N: "+ n)
                $(`.grading-tbody > tr:nth-of-type(${n}) > td.service_orientation_score option[value=${csScore1}]`).attr("selected", "selected")
                $(`.grading-tbody > tr:nth-of-type(${n}) > td.result_orientation_score option[value=${csScore2}]`).attr("selected", "selected")
                $(`.grading-tbody > tr:nth-of-type(${n}) > td.flexibility_and_adaptability_score option[value=${csScore3}]`).attr("selected", "selected")
                $(`.grading-tbody > tr:nth-of-type(${n}) > td.make_it_happen_score option[value=${lsScore1}]`).attr("selected", "selected")
                $(`.grading-tbody > tr:nth-of-type(${n}) > td.provide_solutions_score option[value=${lsScore2}]`).attr("selected", "selected")
                $(`.grading-tbody > tr:nth-of-type(${n}) > td.inspire_people_score option[value=${lsScore3}]`).attr("selected", "selected")
    
            }

            pageButtons(Data, data.pages)

        }
    </script>
  
    <script src="./KPI_dropdown_control.js "></script>
    <script src="./KPI_comment_box_control.js"></script>
    <script src="./KPI_dynamic_input.js"></script>
    <!-- <script src="./KPI_row_status_control.js"></script> -->
    <script src="./KPI_score_calculation.js"></script>
    <!-- <script src="./KPI_row_status_submit.js"></script> -->
    <script src="./KPI_items.js"></script>
    <script src="./KPI_breadcrumb_control.js"></script>
</body>


</html>